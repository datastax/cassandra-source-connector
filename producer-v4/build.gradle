plugins {
    id 'java-library'
}

application {
    mainClass.set(project.getProperty("mainClassName"))
}


jar {
    duplicatesStrategy = DuplicatesStrategy.INCLUDE
    manifest {
        attributes 'Premain-Class': "$mainClassName"
    }
    zip64=true
}

tasks.jar.dependsOn project(':commons').jar
tasks.jar.dependsOn project(':producer').jar

compileTestJava {
    options.compilerArgs += '-parameters'
}

sourceSets {
    // Make the compileOnly dependencies available when compiling/running tests
    test.compileClasspath += configurations.compileClasspath
    test.runtimeClasspath += configurations.compileClasspath
}

dependencies {
    implementation project(':commons')
    implementation project(':producer')
    implementation("io.debezium:debezium-core:${debeziumVersion}")
    compileOnly("org.apache.cassandra:cassandra-all:${cassandra4Version}")
}
